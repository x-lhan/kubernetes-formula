{% set bind_iface = eth0 %}
{% set cluster_tag = "default" %}
{% set pki_path = "/var/salt/k8s-helper/pki/" + cluster_tag + "/" %}

mine_functions:
  network.internal_ip:
    - mine_function: grains.get
    - 'ip_interfaces:{{ bind_iface }}:0'

kubernetes:
  k8s_env: {{ cluster_tag }}
  # scope master/pool nodes by minion_id
  {% if grains['id'].startswith('k8s-master') %}
  master: True
  {% elif grains['id'].startswith('k8s-pool') %}
  pool: True
  {% endif %}

  # which host interface to bind, default eth0. when changed please make sure mine funcation "network.internal_ip" is also changed
  bind_iface: {{ bind_iface }}

  # Override default token for security practice
  token:
    admin: REPLACE_ME_WITH_BASE64_TOKEM_FOR_ADMIN
    kube_proxy: REPLACE_ME_WITH_BASE64_TOKEM_FOR_KUBE_PROXY
    kubelet:  REPLACE_ME_WITH_BASE64_TOKEM_FOR_KUBELET
  
  # please use the k8s-helper.generate_certs runner to generate the certificates
  certs:
    "ca.crt": |
      {{ salt.cmd.run("cat " + pki_path + "ca.crt") | indent(8) }}
    "kubecfg.crt": |
      {{ salt.cmd.run("cat " + pki_path + "kubecfg.crt") | indent(8) }}
    "kubecfg.key": |
      {{ salt.cmd.run("cat " + pki_path + "kubecfg.key") | indent(8) }}
    "server.cert": |
      {{ salt.cmd.run("cat " + pki_path + "server.crt") | indent(8) }}
    "server.key": |
      {{ salt.cmd.run("cat " + pki_path + "server.key") | indent(8) }}

  # Please reference default.yml file for more configurable pillar data 
